language: php
php:
- 7.0
sudo: false
cache:
  directories:
  - node_modules
  - vender
  - $HOME/.composer/cache
services:
- mysql
before_install:
- nvm install 0.12
- nvm use 0.12
install:
- composer install
- npm install
- npm install gulp
- npm install bower
- bower install
before_script:
- mysql -e 'create database braddersrocks;'
- cp  .env.travis .env
- php artisan migrate --seed --force
- php artisan key:generate
script:
- gulp
branches:
  only:
  - master
before_deploy:
- git config --global user.email 'brad.bird.x@gmail.com'
- git config --global user.name 'Brad Bird'
- git add public -f
- git commit -m 'Add build assets'
deploy:
  skip_cleanup: true
  provider: heroku
  api_key:
    secure: "Y2u6JgTnc/wCqde0nSQZVKKLOL44D1IppC/a3zu7f1mGW7EjtcLY1/ABrgDXlv8ExU8vPz+ECBTIP+Ef6Me7647QLZnpVJaDX4ntJs5GkPhVz2l91nbUu0YVa5KoFZkhnMIW2kcIYmdUzMw8aNvSuX88C02WkNLYKBBcqDOhsJEyriwohh37wmHxoz36wsBpBVxFRlteDmQWIfvGLartrctyBRZzFGGgdSBtEAQZ/l3TUhaIPNJS3HvuZyeUfFAHE9Y2w+6lC3PHQcDXhoiBjmEtHaCJFeDdVaPnrm+aqk9qZPIYgWTQwzn6uo+5Wt4bOaru7yiQxlhB7y63HVsIxQtGBbib5MBaEGPqT1pxGvofp5kYYDhSvNDku2XjCq2DQGXHjTieMACUx2iOPciK2moBbbAyyTi1SeHLUdF3gAEbVG1DG7te/U6aSQB8gww9Cq4hrSmtDRsK8pdgKjFy3c6uKKgjKBRWJKja1x+mIDdUmxw1fMAJwG82rblagPIH+YlaZQpIL1YX4clKXv/R4ldmU7ZuBbjTp0CsKU4PImDE+3xiBlLlKt4avMrIySeTL7E653GTfaqlGOZERo2Wc35qct+ANOUigrdKLeSq2OjOcwe4WAYm/bH6rtbh/6cItxNdfFoBz+UHBauzWoFhyZyktySKAquRbqqOsDMPam4="
  strategy: git
  app:
    master: bradders-rocks
  run: php /app/artisan migrate --force
notifications:
  email: brad.bird.x@gmail.com
