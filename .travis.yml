language: php
php:
- 7.0
sudo: false
cache:
  directories:
  - node_modules
  - vender
  - $HOME/.composer/cache
services:
- mysql
before_install:
- nvm install 0.12
- nvm use 0.12
install:
- composer install
- npm install
- npm install gulp
- npm install bower
- bower install
before_script:
- mysql -e 'create database braddersrocks;'
- cp  .env.travis .env
- php artisan migrate --seed --force
- php artisan key:generate
script:
- gulp
branches:
  only:
  - master
before_deploy:
- git config --global user.email 'brad.bird.x@gmail.com'
- git config --global user.name 'Brad Bird'
- git add public -f
- git commit -m 'Add build assets'
deploy:
  skip_cleanup: true
  provider: heroku
  api_key:
    secure: ndQaAfi8RgLqW6xL3onH7EYqt1Dh+uy8FZJOVGS0UzoQMFQ2HEhahSlt9bmLGclvTdoAHmUtBJ8Ge/WUoS67LLAxsZFO3kPcSl2vW3vZUFvwULz1p24rdw9D/m/uxMTLD0NQdqkgtPwcdLIsFNCJyY9vbU5DQ9b34Y6becu1uTIQLwAxrx2zNOXnQQfeGMW0nR52oCT+26ZlmgKPUzgkOLrlPEDxu95TjLeucpDE2q0H/De98ugJ/sF5kilz2jjR0ILJMN4q6+3rblJsVJB1ovIFDYkuIp9c3Gdvq2V9kEXCw2P0++Jdd7+m7Oe9pEVgWUfV2i7tNboVrw8iBKPxalO28TFvw0dZO3BrFg9w1DjO4ijLz+jM5l18iJV6/x+F74Qj7IrnIGxYCqGR6GR0m7NdFAJ8GYYgZBltOANs2VNaNX2ALS4GcJ+wXM3QWDL4WTja6yHrNfOuApj2QaJmpwWFKOralSHVZMfQWC5smbVa5k49DDEsYSbxIuz+UbY6BEkHoH9ai99gSFbf8pFiuSNt4NTS0hwYQ5yOsXhWBpgZf2El0a4oWkkTSUxOrcG8Cews+5uK3feyCUIiQu/lCovezGBG0hwsWM1212awVW/KbR2WyoKUAStfoa+fpESIDb+WQ646t9dxQ779Cadgj922tvDPppikpukJB1GJmok=
  strategy: git
  app:
    master: bradders-rocks
  run: php /app/artisan migrate --force
notifications:
  email: brad.bird.x@gmail.com
